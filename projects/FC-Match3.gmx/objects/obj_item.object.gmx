<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_gameplay_items</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-10</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>randomize();

row = 0;
column = 0;
top_cell = 0;
ver_shift = 0; // до след. ячейки
ver_speed = 30*global.spd;//17.5*global.spd;
ver_axel = 0.01;
ver_spd = 0;

selected = 0;
last_selected = 0;
selected_num = 0;
turn_to = 0; //для гриба. индекс во что превратится после баунса
bouce_size=0.025*global.spd;

alarmtime = 6;
falling = 0;
fall = 0;
y_start = 0;
//0-падает, еще не освободила
//1-падает, уже освободила

//эффекты на итемах висящие
effect_destroy_row=0; //1-горизонталь, 2-вертикаль
effect_alpha = -0.005*global.spd;

image_speed = 0;
image_index = ds_list_find_value(obj_controller_gameplay.types_list,round(random_range(0-0.49,ds_list_size(obj_controller_gameplay.types_list)-1+0.49)));
index = image_index;

//spawn shadow
shadow=instance_create(x,y+30,obj_item_shadow);
shadow.image_index=image_index;
shadow.target=id;
white = 0;
//for white layer
//white = instance_create(x,y,obj_item_white);
//white.image_index=image_index;
massbounce=0;

visible=0;
shadow.visible=0;
alarm[0]=1;


//bounce variables
moveup_time=0;
t = 0;
moveup_side = 1;
shift = 0;


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
with shadow instance_destroy();

if white!=0 with white instance_destroy();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="9">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Setup 2

if row!=0 {
    visible=1;
}

image_xscale=0;
image_yscale=0;

timeline_index = tml_item_bounce;
timeline_position = 0;
timeline_running = true;
timeline_loop = 0;
timeline_speed = 0.5*global.spd;

if global.pause=1 {
var ptch=random_range(0.8,1.2);
var gain=random_range(0.2,0.4);
scr_sound(snd_appear,1,0,ptch,gain);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="8">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if y&lt;y_start {
    y+=(y_start-y_curr)/(6*global.spd);
    alarm[8]=1;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///after freeze destroy

/*with obj_item {
    if alarm[6] &gt; 4 {
        other.alarm[6]=alarm[6]-1;
        exit;
    }
}*/

scr_destroy_item_afterfreeze(id);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//create white thing
if white = 0 {
white = instance_create(x,y,obj_item_white);
white.image_angle=0+90*(effect_destroy_row-1);
white.target=id;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Grib bounce

index=turn_to;
image_index=index;
shadow.image_index=image_index;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///bounce
y+=2.5*global.spd;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///destroy

scr_destroy_item(id);
global.item_num[index]+=1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Setup


depth=-10-row;
obj_controller_gameplay.item[column,row]=1;
y_start=y;

if massbounce=0 alarm[9]=1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if row!=7 {   //если это не самый нижний, которому некуда падать    
    if obj_controller_gameplay.item[column,row+1]!=1 {  //если под ним ячейка пустая
        if falling!=1 {
            obj_controller_gameplay.item[column,row]=0;//освобождает свою старую ячейку
            obj_controller_gameplay.item[column,row+1]=2;
            if row=0 obj_controller_gameplay.alarm[column]=room_speed/alarmtime;
            ver_spd=ver_speed;
            falling=1 }      
        fall = 1;
        ver_spd=(ver_spd*ver_axel)+ver_spd;//на сколько итем ща упадет
        
        if y+ver_spd &lt;= top_cell+row*ver_shift y+=ver_spd; //он упадет выше середины след. ячейки? 
        else {
            row+=1;  
            if row=1 {visible=1; shadow.visible=1;}         
            if row&lt;7 and obj_controller_gameplay.item[column,row+1]=0 { //если и дальше пусто, падать дальше
                obj_controller_gameplay.item[column,row]=0;//освобождает свою старую ячейку
                obj_controller_gameplay.item[column,row+1]=2;
                y+=ver_spd;
            } else {
                fall = 0;
                falling = 0;
                y+=(top_cell+(row-1)*ver_shift)-y; //если полностью не упасть на свою скорость, падает ровно до середины нужной ячейки
                y+=5;
                alarm[3]=2;
                y_start=y;
                obj_controller_gameplay.item[column,row]=1; //теперь занята эта ячейка
                depth=-10-row;
            }
        }
        
        shadow.y=y+30-selected*30;
    } else {
        if fall=1 alarm[1]=1;
    }
}

if alarm[7]&gt;1 {
    t = sqrt(abs(alarm[7]-moveup_time));
    shift = (moveup_side*(-power(t,2) + moveup_time/2))*(1.5*global.spd*global.spd);
    y+=shift;
    //if y&gt;y_start y=y_start;
}
    
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
