<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_bookmarks_plash</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-2</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>instance_activate_all();

image_speed = 0;
global.bookmark = 3;
global.bookmark_target = 3;
global.bookmark_current = 1;//obj_bookmark_page
global.bookmark_moved = 0;
global.bookmark_level = 0;
global.bookmark_last_outer = 3;//куда возвращаться, если забрели в дебри внутренних закладок
//global.bookmark_last_inner - кстати и такой тоже нужен?
//0 - верхний уровень, где сами букмарки
//все что ниже - какие то подуровни, где закладки должны уезжать и не работать
//1    - уровни   // магазин
//2    - прокачки // прокачки
//3    - сундуки  // уровни
//4    - магазин  // сундуки
//5    - рекорды  // рекорды
//1(6) - магазин(на подуровне)
//2(7) - квесты
//3(8) - море геймс
//4(9) - гифты (фейсбук)
//5(10) - промокоды
//6(11) - фидбэк
bookmark_moves = 0;
page_moves = 0;
global.scr_test = 0;

var shft=10;
mark1 = instance_create(room_width/2-184*2,room_height-81-shft,obj_bookmark);
mark1.bookmark_index=1;
mark2 = instance_create(room_width/2-184,room_height-81-shft,obj_bookmark);
mark2.bookmark_index=2;
mark3 = instance_create(room_width/2,room_height-81-shft,obj_bookmark);
mark3.bookmark_index=3;
mark4 = instance_create(room_width/2+184,room_height-81-shft,obj_bookmark);
mark4.bookmark_index=4;
mark5 = instance_create(room_width/2+184*2,room_height-81-shft,obj_bookmark);
mark5.bookmark_index=5;

//пять внешних закладок
page1 = instance_create(0,0,obj_bookmark_page);
page1.bookmark_page=1;
page1.inner_bookmark=0;
page2 = instance_create(0,0,obj_bookmark_page);
page2.bookmark_page=2;
page2.inner_bookmark=0;
page3 = instance_create(0,0,obj_bookmark_page);
page3.bookmark_page=3;
page3.inner_bookmark=0;
page4 = instance_create(0,0,obj_bookmark_page);
page4.bookmark_page=4;
page4.inner_bookmark=0;
page5 = instance_create(0,0,obj_bookmark_page);
page5.bookmark_page=5;
page5.inner_bookmark=0;
//внутренние закладки
page6 = instance_create(0,0,obj_bookmark_page);//1 - магазин(на подуровне)
page6.bookmark_page=6;
page6.inner_bookmark=1;
page6 = instance_create(0,0,obj_bookmark_page);//2 - квесты(на подуровне)
page6.bookmark_page=7;
page6.inner_bookmark=1;
page6 = instance_create(0,0,obj_bookmark_page);//3 - отзыв(на подуровне)
page6.bookmark_page=8;
page6.inner_bookmark=1;
page6 = instance_create(0,0,obj_bookmark_page);//4 - промокод(на подуровне)
page6.bookmark_page=9;
page6.inner_bookmark=1;
page6 = instance_create(0,0,obj_bookmark_page);//5 - fb подарки(на подуровне)
page6.bookmark_page=10;
page6.inner_bookmark=1;

//2 - квесты
//3 - море геймс
//4 - гифты (фейсбук)
//5 - промокоды
//6 - фидбэк

instance_create(0,0,obj_hud);
shift_x = 0;
shift_y = 0;
shift_time = 0;

//для здвига нижней штуки
t=0;
move_side=-1;
shiftt=0;
stopped = 1;
close_time = 20/global.spd;//10;
shift_speed=5/(4/global.spd/global.spd);

//делаем бэйджи
alarm[2]=room_speed/2;



/*var u=0;
var c=0;
for(var i=0;i&lt;24;i++) { // есть ли закончившиеся прокачки
    if Main.upgrade[i+1,7]=2 u+=1;
}
for(var i=0;i&lt;9;i++) {  // есть ли открытые сундуки
    if Main.chest_time[i+1]=2 c+=1;
}

if u &gt; 0 {
    var badge = instance_create(0,0,obj_badge);
    badge.target = mark2;
    badge.parent = page2;
    badge.num=u;
    if badge.num&gt;9 badge.num='...';
    badge.x=badge.target.x+badge.x_shift;
    badge.y=badge.target.y+badge.y_shift;
}
if c &gt; 0 {
    var badge2 = instance_create(0,0,obj_badge);
    badge2.target = mark4;
    badge2.parent = page4;
    badge2.num=c;
    badge2.x=badge2.target.x+badge2.x_shift;
    badge2.y=badge2.target.y+badge2.y_shift;
}
*/

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///бэйджи и реклам окно
randomize();

var u=0;
var c=0;
var q=0;
for(var i=0;i&lt;24;i++) { // есть ли закончившиеся прокачки
    if Main.upgrade[i+1,7]=2 u+=1;
}
for(var i=0;i&lt;9;i++) {  // есть ли открытые сундуки
    if Main.chest_time[i+1]=2 c+=1;
}
for(var i=0;i&lt;3;i++) {  // есть ли открытые сундуки
    if Main.quest_progress[i]&gt;=Main.quest_target[i] and Main.quest_type[i]!=-1 q+=1;
}

if u &gt; 0 {
    var badge = instance_create(0,0,obj_badge);
    badge.target = mark2;
    badge.parent = page2;
    badge.num=u;
    if badge.num&gt;9 badge.num='...';
    badge.x=badge.target.x+badge.x_shift;
    badge.y=badge.target.y+badge.y_shift;
}
if c &gt; 0 {
    var badge2 = instance_create(0,0,obj_badge);
    badge2.target = mark4;
    badge2.parent = page4;
    badge2.num=c;
    badge2.x=badge2.target.x+badge2.x_shift;
    badge2.y=badge2.target.y+badge2.y_shift;
}
if q &gt; 0 {
    var badge3 = instance_create(0,0,obj_badge);
    badge3.target = mark1;
    badge3.parent = page1;
    badge3.num=q;
    badge3.x=badge3.target.x+badge3.x_shift;
    badge3.y=badge3.target.y+badge3.y_shift;
    badge3.type=1;
}

//рекламное очко думает, вылезти или нет
if AdColony_VideoAvailable()=1 or GoogleMobileAds_InterstitialStatus()=="Ready" {//работает ли в принципе реклама чтоб был смысл лезть
    var curr_time=date_current_datetime();
    var popup_chance=0;
    
    if Main.last_add_offer=0 or date_inc_hour(Main.last_add_offer,2)&lt;Main.last_add_offer /*date_compare_datetime(date_inc_hour(Main.last_add_offer,2),curr_time)=curr_time*/ {//если последнего такого окна не было минимум 2 часа
        if Main.last_add!=0 {
            var add_chance = ceil(date_hour_span(Main.last_add, curr_time)/2);
            if add_chance&gt;26 add_chance=26;//как давно была последняя реклама, макс 3 дня     0-26
            popup_chance+=add_chance;
        
            if Main.inap=0 popup_chance+=24;//повышается сильно если не было инапа            0-24
        
            var lvl_chance=Main.level_passed/100; //выходит на макс обороты после 300 лвл?    0-20
            if lvl_chance&gt;3 lvl_chance=3;
            popup_chance+=(lvl_chance*10)/1.5;
            
            source[0]= (Main.gold&lt;Main.level_passed*10);//каждый предмет добавляет малеха     0-30
            source[1]= (Main.gems&lt;5);
            source[2]= (Main.silver_keys&lt;3);
            source[3]= (Main.gold_keys&lt;2);
            source[4]= (Main.powerup_num[1]&lt;4);
            source[5]= (Main.powerup_num[2]&lt;4);
            source[6]= (Main.powerup_num[3]&lt;4);
            source[7]= (Main.powerup_num[4]&lt;4);
            source[8]= (Main.powerup_num[5]&lt;4);
            
            var shfl_list=ds_list_create();
            ds_list_add(shfl_list,0,1,2,3,4,5,6,7,8);
            ds_list_shuffle(shfl_list);
            
            var sources_max=0;
            var absent_string='';
            for(var i=0;i&lt;9;i++) {//запоминаем чего не хватает
                if source[ds_list_find_value(shfl_list,i)]&gt;0 {
                    if sources_max&lt;2 {
                        sources_max+=1; 
                        popup_chance+=15; 
                        absent_string+=string(ds_list_find_value(shfl_list,i)); 
                        ds_list_replace(shfl_list,i,9);//заменяем то, что убралось, нонсенсом
                    }
                } 
            }
            
            for(var i=0;i&lt;sources_max;i++) {//убираем до двух нонсенсов 
                if ds_list_find_index(shfl_list, 9)!=-1 ds_list_delete(shfl_list,ds_list_find_index(shfl_list, 9));
            }
            ds_list_shuffle(shfl_list);
            
            for(var i=0;i&lt;(3-sources_max);i++) {//добавляем в лист случайные числа до 3х
                if string_length(absent_string)&lt;3 absent_string+=string(ds_list_find_value(shfl_list,i));
            }
            ds_list_destroy(shfl_list);
            
            for(var i=0;i&lt;3;i++) {//ну и совсем уж окончательная проверка что это строка норм
                if string_length(absent_string)&lt;3 absent_string+=choose(0,1,2,3,4,5,6,7,8);
            }
            if string_length(absent_string)&gt;3 absent_string=string_copy(absent_string,1,3);
            
            var popup_floor = 40 //минимальный порог когда может заспауниться
            var chance_to_show = popup_floor+ceil(random_range(0,100-popup_floor));
            if popup_chance&gt;chance_to_show scr_show_bluring_menu(13,real(absent_string));//под-меню это будут три цифры предметов
            //Main.custom = string(popup_chance)+' // '+string(chance_to_show);
            
               
    }
    }
}


//свинья помощник
tip=instance_create(room_width/2+350,1895,obj_tip_pig);
tip.alarm[1]=room_speed;
tip.alarm[4]=room_speed*0.65;
if Main.tutorial=1 tip.line=0;
else tip.line=choose(6,7,8);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Slide end

stopped=1;


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if !stopped {
    t = sqrt(abs(alarm[1]-close_time));
    shiftt = (move_side*(-power(t,2) + close_time))*shift_speed;
    y += shiftt;
    with obj_bookmark y+=other.shiftt*1.5;
    with obj_tip_pig y+=other.shiftt*1.5;
}

if device_mouse_check_button_pressed(0,mb_left) {
    shift_x = device_mouse_x(0);
    shift_y = device_mouse_y(0);
    shift_time = 0;
} else if device_mouse_check_button(0,mb_left) {
    shift_time +=1;
} else if device_mouse_check_button_released(0,mb_left) {
    if shift_time&gt;room_speed/3 or global.bookmark&gt;5 exit;
    shift_time = 0;
    if shift_y&gt;190 and shift_y&lt;1770 {
        if device_mouse_y(0)&gt;190 and device_mouse_y(0)&lt;1770 {
            if abs(device_mouse_x(0)-shift_x)&gt;400 {
                if point_direction(min(shift_x,device_mouse_x(0)),max(shift_y,device_mouse_y(0)),max(shift_x,device_mouse_x(0)),min(shift_y,device_mouse_y(0)))&lt;=30 {
                    if shift_x&gt;device_mouse_x(0) { // влево
                        if obj_controller_bookmark.page_moves=0 { //если не двигается
                            with obj_bookmark {
                                if bookmark_index = global.bookmark_current.bookmark_page+1 scr_bookmark_goto(id);
                            }
                        } else {
                            with obj_bookmark {
                                if bookmark_index = global.bookmark_target+1 scr_bookmark_goto(id);
                            }    
                        }
                    } else { // вправо  
                        if obj_controller_bookmark.page_moves=0 { //если не двигается
                            with obj_bookmark {
                                if bookmark_index = global.bookmark_current.bookmark_page-1 scr_bookmark_goto(id);
                            }
                        } else {
                            with obj_bookmark {
                                if bookmark_index = global.bookmark_target-1 {scr_bookmark_goto(id); exit;}
                            } 
                        }
                    }
                }
            }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_self();
if global.bookmark_level=0 draw_sprite_part(sprite_index,1,(room_width/2-184*3+LSHIFT)+184*(global.bookmark-1), 0, 184, 198, (room_width/2-184*3+LSHIFT)+184*(global.bookmark-1)+5, y-198);

/*draw_text(room_width/2,room_height/2+100,global.bookmark_target);
draw_text(room_width/2,room_height/2+200,global.scr_test);*/

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
