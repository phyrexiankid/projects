<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_title_lid</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>mode=0;
//0 - пытаемся получить инфу от фейсбука,
//или какая то первоначальная загрузка
//1 - играют
//2 - пригласить
//3 - не залогинились (кнопка фейсбука)
//4 - ченить там облом, нет сети итд

target=0;
x_shift=0;
y_shift=0;

cc_shadow=make_color_rgb(6,22,6);
cc_ttl_light=make_color_rgb(255,232,219);
cc_ttl_dark =make_color_rgb(166,67,15);
color1=cc_ttl_dark;
color2=cc_ttl_light;

friends_fb=0;
friends_plaing=0;
friends_height[0]=0;
friends_height[1]=0;

gifts_checked=0;
gifts_check =0;
txt_nofriends[0]=mtf.l_book[10,1];
txt_nofriends[1]=mtf.l_book[10,2];
txt_nofriends[2]=mtf.l_book[10,3];
txt_nofriends[3]=mtf.l_book[10,4];
txt_nofriends[4]=mtf.l_book[10,5];

// buttons
button_login=0;
fb_button=0;
button_invite=0;

//дальше там где он создается будет эта строчка
//ds_list_add(target.child_list,button_invite_all,button_send_all); //сюда плашки которые он делает

//alarm[0]=1;

//для здвига нижней штуки
t=0;
move_side=-1;
shiftt=-188;
stopped = 1;
close_time = 12;

                   
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///ckeck gifts

scr_reciece_gifts(2);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///get playing friends
if ds_map_exists(fb_playing_recieve, "context") { 
    mode=1;
    //var data_list_curr,request_score,request_user,request_id,requester_id; 
    var context_map=ds_map_find_value(fb_playing_recieve,"context");           // ds_map
    var friends_map=ds_map_find_value(context_map,"friends_using_app");        // ds_map
    var data_list=ds_map_find_value(friends_map,"data");                       // dslist
    
    if ds_list_empty(data_list) {
        //destroy maps, free memory
        ds_list_destroy(data_list);
        ds_map_destroy(context_map);
        ds_map_destroy(friends_map);
        //no new requests, exit
        exit;
    }
    
    var strt = 700-188;//805
    for(var i=0; i&lt;ds_list_size(data_list); i++) {
        var this_friend_map = ds_list_find_value(data_list, i);          // ds_map
        fb_friend_name[i]  = ds_map_find_value(this_friend_map, "name")  // value       
        fb_friend_id[i]    = ds_map_find_value(this_friend_map, "id")    // value    
            
        var xx=x;
        var yy=strt+233*i;
        var plash = instance_create(xx,yy,obj_bookmark_gifts_friend);
        plash.target=target;
        plash.x_shift=0;
        plash.y_shift=yy;
        plash.friend_name = string(fb_friend_name[i]);
        plash.friend_id   = fb_friend_id[i];
        ds_list_add(target.child_list,plash);
        with plash {
            invite_button = instance_create(x,y,obj_button);
            invite_button.index = 42;
            invite_button.father=id;
            invite_button.target=other.target;
            invite_button.x_shift=x_shift+345;
            invite_button.y_shift=y_shift-10;
            invite_button.depth=0;
            ds_list_add(other.target.child_list,invite_button);
        }
            
        
        friends_plaing+=1;
        //destroy maps, free memory
        ds_map_destroy(this_friend_map);
    }
    if friends_plaing=0 friends_plaing=-1;
    if friends_plaing!=-1 {
      scr_show_bottom_plash();
      target.bookmark_height=strt+233*(i-1)/*+130*/;
      target.bookmark_add_min=0;//-250;
    }
    //destroy maps, free memory
    ds_list_destroy(data_list);
    ds_map_destroy(context_map);
    ds_map_destroy(friends_map);
    
} else {

    scr_fb_get_playing();

}


/*
{
  "context": {
    "friends_using_app": {
      "data": [
        {
          "name": "Zuek Zuekson",
          "id": "202516373614710"
        },
        {
          "name": "Regina Yushkova",
          "id": "10209808600919871"
        }
      ],
      "paging": {
        "cursors": {
          "before": "MjAyNTE2MzczNjE0NzEw",
          "after": "MTAyMDk4MDg2MDA5MTk4NzEZD"
        }
      },
      "summary": {
        "total_count": 2
      }
    },
    "id": "YXBwbGljYXRpb25fY29udGV4dDoyNTE0ODQ2NDg2OTkwMDkZD"
  },
  //"id": "251484648699009"
}*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///check connection

var status=facebook_status();

if status="AUTHORISED" {
  Main.fb_connected=1;
  scr_save();
  if fb_button!=0 { 
    ds_list_delete(target.child_list,ds_list_find_index(target.child_list,fb_button));
    with fb_button instance_destroy();
    fb_button=0;
  }
  mode=1;
  if friends_plaing=0 scr_fb_get_playing();
} else if status="FAILED" {
  Main.fb_connected=0;
  scr_save();
} else {
  alarm[2]=room_speed;
}



</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Slide end

stopped=1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///spawn buttons
/*button_invite_all = instance_create(room_width/2,1936,obj_button);//кнопка пригласить всех 
button_invite_all.index=37;
button_invite_all.x_shift=0;
button_invite_all.target=id;
button_send_all = instance_create(room_width/2,1936,obj_button);//кнопка отправить всем
button_send_all.index=36;
button_send_all.x_shift=0;
button_send_all.target=id;
button_playing = instance_create(room_width/2-200,y+107,obj_button);//кнопка играют
button_playing.index=38;
button_playing.x_shift=-200;
button_playing.target=id;
button_invite = instance_create(room_width/2+200,y+107,obj_button);//кнопка пригласить
button_invite.index=39;
button_invite.x_shift=200;
button_invite.target=id;

//спаун панелей с друзьями. вообще хз где они будут, потом возьмем оттуда
//может так же они будут в два объекта, и в кнопке переключается видимость одних или других
with target {
randomize();
var playing=    choose(0,3,9,15);
var not_playing=choose(0,3,9,15);
other.friends_plaing=playing;
other.friends_fb=not_playing;

for(var i=0; i&lt;playing; i++) {     
    var xx=x;
    var yy=575+233*playing;
    var plash = instance_create(xx,yy,obj_bookmark_gifts_friend);
    plash.target=id;
    plash.x_shift=0;
    plash.y_shift=yy;
    plash.playing=1;
    ds_list_add(child_list,plash); //все это вносим в список детей
}

for(var i=0; i&lt;not_playing; i++) {     
    var xx=x;
    var yy=575+233*not_playing;
    var plash = instance_create(xx,yy,obj_bookmark_gifts_friend);
    plash.target=id;
    plash.x_shift=0;
    plash.y_shift=yy;
    plash.playing=0;
    ds_list_add(child_list,plash); //все это вносим в список детей
}

bookmark_height=575+233*playing+150;
bookmark_add_min=-150;
}

ds_list_add(target.child_list,button_invite_all,button_send_all,button_playing,button_invite); //сюда плашки которые он делает
*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if !stopped {
    t = sqrt(abs(alarm[1]-close_time));
    shiftt = close_time-(move_side*(-power(t,2) + close_time))*24;
    //with obj_bookmark y+=other.shiftt*6;
    
    with button_invite y=view_hview[0]-112-other.shiftt;
}

//x=target.x+x_shift;

if mode=1 or mode=2 {
draw_sprite(sp_bookmarks_plash,0,view_xview[0],view_hview[0]-shiftt);

draw_set_valign(fa_middle);
draw_set_halign(fa_center);
draw_set_color(c_white);
draw_set_font(font_30);
if friends_plaing=0 draw_text(x,1070+45,txt_nofriends[4]);
else if friends_plaing=-1 draw_text(x,1070+45,txt_nofriends[1]);
} else if mode = 3 {//не залогинен в фб (но сеть есть)

draw_set_valign(fa_middle);
draw_set_halign(fa_center);
draw_set_color(c_white);
draw_set_font(font_30);
if friends_fb=0 draw_text(x,875,txt_nofriends[3]);
else draw_text(x,1070+45,txt_nofriends[4]);
//кнопка здесь делается когда мы понимаем что в сети и не залогинены
//и никуда не двигается
//ломается если уходим с закладки или успешно логинимся
} else if mode = 0 { //еще проверяем залогинен ли
draw_set_valign(fa_middle);
draw_set_halign(fa_center);
draw_set_color(c_white);
draw_set_font(font_30);
draw_text(x,1070+45,txt_nofriends[4]);
}

//+107 середина
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="83">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var status=facebook_status();
log(string('status=')+string(status));
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="77">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>log(string('mode=')+string(mode));
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
